
============================================================
üöÄ PLANWISE NAVIGATOR - MVP ORCHESTRATOR
============================================================

üóìÔ∏è MULTI-YEAR SIMULATION MODE WITH CHECKLIST ENFORCEMENT
This tool will run a complete multi-year workforce simulation
using the configuration parameters from test_config.yaml
Each step will be validated to ensure proper sequencing.

‚ö° Running in non-interactive mode (skipping all breaks)

============================================================
CLEARING DATABASE
============================================================

Found 11 tables to drop:
  - comp_levers
  - config_cola_by_year
  - config_job_levels
  - config_promotion_hazard_age_multipliers
  - config_promotion_hazard_base
  - config_promotion_hazard_tenure_multipliers
  - fct_yearly_events
  - int_baseline_workforce
  - int_workforce_previous_year
  - stg_census_data
  - stg_config_job_levels

Dropping foreign key constraints...
  ‚ö†Ô∏è  Could not query foreign key constraints: Binder Error: Referenced column "table_schema" not found in FROM clause!
Candidate bindings: "duckdb_constraints.table_name"
LINE 5:         AND table_schema = 'main'
                    ^
  ‚úì No foreign key constraints found or dropped

Dropping tables...
  ‚úì Dropped comp_levers
  ‚úì Dropped config_cola_by_year
  ‚úì Dropped config_job_levels
  ‚úì Dropped config_promotion_hazard_age_multipliers
  ‚úì Dropped config_promotion_hazard_base
  ‚úì Dropped config_promotion_hazard_tenure_multipliers
  ‚úì Dropped fct_yearly_events
  ‚úì Dropped int_baseline_workforce
  ‚úì Dropped int_workforce_previous_year
  ‚úì Dropped stg_census_data
  ‚úì Dropped stg_config_job_levels

‚úÖ Database completely cleared!

============================================================
RUNNING DBT MODEL: stg_census_data
============================================================

Executing command: dbt run --select stg_census_data
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:00  Running with dbt=1.9.8
[0m14:52:00  Registered adapter: duckdb=1.8.1
[0m14:52:00  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:00
[0m14:52:00  Concurrency: 10 threads (target='dev_m4')
[0m14:52:00
[0m14:52:01  1 of 1 START sql table model main.stg_census_data .............................. [RUN]
[0m14:52:01  1 of 1 OK created sql table model main.stg_census_data ......................... [[32mOK[0m in 0.11s]
[0m14:52:01
[0m14:52:01  Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:52:01
[0m14:52:01  [32mCompleted successfully[0m
[0m14:52:01
[0m14:52:01  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


‚úÖ Successfully ran stg_census_data

============================================================
INSPECTING: stg_census_data
============================================================
‚úì Table main.stg_census_data exists
‚úì Table contains 5,000 rows
‚úì No NULL values in employee_id column

Table has 15 columns:
  - employee_id: VARCHAR
  - employee_ssn: VARCHAR
  - employee_birth_date: DATE
  - employee_hire_date: DATE
  - employee_termination_date: DATE
  - employee_gross_compensation: DOUBLE
  - active: BOOLEAN
  - employee_plan_year_compensation: DOUBLE
  - employee_annualized_compensation: DOUBLE
  - employee_capped_compensation: DECIMAL(12,2)
  - employee_deferral_rate: DECIMAL(2,1)
  - employee_contribution: DECIMAL(2,1)
  - employer_core_contribution: DECIMAL(2,1)
  - employer_match_contribution: DECIMAL(2,1)
  - eligibility_entry_date: DATE

Sample data (first 5 rows):
| employee_id   | employee_ssn   | employee_birth_date   | employee_hire_date   | employee_termination_date   |   employee_gross_compensation | active   |   employee_plan_year_compensation |   employee_annualized_compensation |   employee_capped_compensation |   employee_deferral_rate |   employee_contribution |   employer_core_contribution |   employer_match_contribution | eligibility_entry_date   |
|:--------------|:---------------|:----------------------|:---------------------|:----------------------------|------------------------------:|:---------|----------------------------------:|-----------------------------------:|-------------------------------:|-------------------------:|------------------------:|-----------------------------:|------------------------------:|:-------------------------|
| EMP_000030    | SSN-744385868  | 1994-12-08 00:00:00   | 2021-10-04 00:00:00  | 2024-10-18 00:00:00         |                        252400 | False    |                            252400 |                             315500 |                            nan |                        0 |                       0 |                            0 |                             0 | 2021-10-04 00:00:00      |
| EMP_000087    | SSN-715721845  | 1985-09-09 00:00:00   | 2024-08-02 00:00:00  | NaT                         |                         90600 | True     |                             90600 |                             217559 |                            nan |                        0 |                       0 |                            0 |                             0 | 2024-08-02 00:00:00      |
| EMP_000091    | SSN-987835379  | 1980-07-22 00:00:00   | 2014-10-04 00:00:00  | NaT                         |                         89800 | True     |                             89800 |                              89800 |                            nan |                        0 |                       0 |                            0 |                             0 | 2014-10-04 00:00:00      |
| EMP_000142    | SSN-751744809  | 2002-05-19 00:00:00   | 2017-08-11 00:00:00  | NaT                         |                         85900 | True     |                             85900 |                              85900 |                            nan |                        0 |                       0 |                            0 |                             0 | 2017-08-11 00:00:00      |
| EMP_000149    | SSN-898154089  | 1993-11-20 00:00:00   | 2019-09-02 00:00:00  | NaT                         |                         98000 | True     |                             98000 |                              98000 |                            nan |                        0 |                       0 |                            0 |                             0 | 2019-09-02 00:00:00      |

Basic Statistics:
  - Unique employees: 5,000
  - Total rows: 5,000
  - Unique SSNs: 5,000
  - Hire date range: 1994-02-09 to 2024-12-28
  - Active employees: 4,378
  - Terminated employees: 622
  - Avg compensation: $92,387.00
  - Compensation range: $50,000.00 to $350,000.00

‚úÖ All validations passed for stg_census_data!

‚ú® Foundational data looks good!
Now let's build on top of it...
Loading config_job_levels...

============================================================
LOADING DBT SEED: config_job_levels
============================================================

Executing command: dbt seed --select config_job_levels
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:02  Running with dbt=1.9.8
[0m14:52:02  Registered adapter: duckdb=1.8.1
[0m14:52:02  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:02
[0m14:52:02  Concurrency: 10 threads (target='dev_m4')
[0m14:52:02
[0m14:52:02  1 of 1 START seed file main.config_job_levels .................................. [RUN]
[0m14:52:02  1 of 1 OK loaded seed file main.config_job_levels .............................. [[32mINSERT 5[0m in 0.08s]
[0m14:52:02
[0m14:52:02  Finished running 1 seed in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:52:02
[0m14:52:02  [32mCompleted successfully[0m
[0m14:52:02
[0m14:52:02  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


‚úÖ Successfully loaded seed config_job_levels
Loading comp_levers...

============================================================
LOADING DBT SEED: comp_levers
============================================================Initialized simulation checklist for years 2025-2029
Initialized MultiYearSimulationOrchestrator for years 2025-2029
Configuration validated successfully
üöÄ Starting multi-year simulation: 2025-2029
üîß Executing pre-simulation setup
üßπ Clearing previous simulation data
‚ö†Ô∏è  Error clearing previous data: Catalog Error: Table with name fct_workforce_snapshot does not exist!
Did you mean "snapshots.scd_workforce_state"?
LINE 1: DELETE FROM fct_workforce_snapshot WHERE simulation...
                    ^
üîç Validating seed data availability
‚úÖ Seed data validation passed
üë• Preparing baseline workforce
üìä Retrieving baseline workforce count
üìä Baseline workforce count: 4,378 employees
‚úÖ Baseline workforce prepared: 4,378 employees
Marked step 'pre_simulation' as complete
‚úÖ Pre-simulation setup completed

üóìÔ∏è  SIMULATING YEAR 2025
==================================================
Beginning simulation year 2025
Marked step 'year_transition' for year 2025 as complete
üìã Step 2: Workforce Baseline Preparation
üìä Year 2025: Using baseline workforce
üìä Retrieving baseline workforce count
üìä Baseline workforce count: 4,378 employees
Starting workforce for 2025: 4,378 employees
Marked step 'workforce_baseline' for year 2025 as complete
‚úÖ Workforce baseline preparation completed (0.02s)
üìã Step 3: Workforce Requirements Calculation
üìà Growth calculation: +877 hires, -526 terminations
Marked step 'workforce_requirements' for year 2025 as complete
‚úÖ Workforce requirements calculation completed (0.00s)
üìã Step 4: Event Generation Pipeline
üé≤ Generating events for year 2025 with seed 42


Executing command: dbt seed --select comp_levers
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:03  Running with dbt=1.9.8
[0m14:52:03  Registered adapter: duckdb=1.8.1
[0m14:52:04  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:04
[0m14:52:04  Concurrency: 10 threads (target='dev_m4')
[0m14:52:04
[0m14:52:04  1 of 1 START seed file main.comp_levers ........................................ [RUN]
[0m14:52:04  1 of 1 OK loaded seed file main.comp_levers .................................... [[32mINSERT 125[0m in 0.07s]
[0m14:52:04
[0m14:52:04  Finished running 1 seed in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:04
[0m14:52:04  [32mCompleted successfully[0m
[0m14:52:04
[0m14:52:04  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "updated_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)


‚úÖ Successfully loaded seed comp_levers
Loading config_cola_by_year...

============================================================
LOADING DBT SEED: config_cola_by_year
============================================================

Executing command: dbt seed --select config_cola_by_year
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:05  Running with dbt=1.9.8
[0m14:52:05  Registered adapter: duckdb=1.8.1
[0m14:52:05  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:05
[0m14:52:05  Concurrency: 10 threads (target='dev_m4')
[0m14:52:05
[0m14:52:06  1 of 1 START seed file main.config_cola_by_year ................................ [RUN]
[0m14:52:06  1 of 1 OK loaded seed file main.config_cola_by_year ............................ [[32mINSERT 6[0m in 0.06s]
[0m14:52:06
[0m14:52:06  Finished running 1 seed in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:06
[0m14:52:06  [32mCompleted successfully[0m
[0m14:52:06
[0m14:52:06  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "created_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "updated_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)


‚úÖ Successfully loaded seed config_cola_by_year
Loading promotion hazard configuration...

============================================================
LOADING DBT SEED: config_promotion_hazard_base
============================================================

Executing command: dbt seed --select config_promotion_hazard_base
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:07  Running with dbt=1.9.8
[0m14:52:07  Registered adapter: duckdb=1.8.1
[0m14:52:07  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:07
[0m14:52:07  Concurrency: 10 threads (target='dev_m4')
[0m14:52:07
[0m14:52:07  1 of 1 START seed file main.config_promotion_hazard_base ....................... [RUN]
[0m14:52:07  1 of 1 OK loaded seed file main.config_promotion_hazard_base ................... [[32mINSERT 1[0m in 0.06s]
[0m14:52:07
[0m14:52:07  Finished running 1 seed in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:07
[0m14:52:07  [32mCompleted successfully[0m
[0m14:52:07
[0m14:52:07  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "created_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "updated_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)


‚úÖ Successfully loaded seed config_promotion_hazard_base

============================================================
LOADING DBT SEED: config_promotion_hazard_age_multipliers
============================================================

Executing command: dbt seed --select config_promotion_hazard_age_multipliers
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:08  Running with dbt=1.9.8
[0m14:52:08  Registered adapter: duckdb=1.8.1
[0m14:52:09  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:09
[0m14:52:09  Concurrency: 10 threads (target='dev_m4')
[0m14:52:09
[0m14:52:09  1 of 1 START seed file main.config_promotion_hazard_age_multipliers ............ [RUN]
[0m14:52:09  1 of 1 OK loaded seed file main.config_promotion_hazard_age_multipliers ........ [[32mINSERT 6[0m in 0.07s]
[0m14:52:09
[0m14:52:09  Finished running 1 seed in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:09
[0m14:52:09  [32mCompleted successfully[0m
[0m14:52:09
[0m14:52:09  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "created_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "updated_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)


‚úÖ Successfully loaded seed config_promotion_hazard_age_multipliers

============================================================
LOADING DBT SEED: config_promotion_hazard_tenure_multipliers
============================================================

Executing command: dbt seed --select config_promotion_hazard_tenure_multipliers
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:10  Running with dbt=1.9.8
[0m14:52:10  Registered adapter: duckdb=1.8.1
[0m14:52:10  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:10
[0m14:52:10  Concurrency: 10 threads (target='dev_m4')
[0m14:52:10
[0m14:52:10  1 of 1 START seed file main.config_promotion_hazard_tenure_multipliers ......... [RUN]
[0m14:52:10  1 of 1 OK loaded seed file main.config_promotion_hazard_tenure_multipliers ..... [[32mINSERT 5[0m in 0.07s]
[0m14:52:10
[0m14:52:10  Finished running 1 seed in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:52:11
[0m14:52:11  [32mCompleted successfully[0m
[0m14:52:11
[0m14:52:11  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "created_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)
/Users/nicholasamaral/planwise_navigator/venv/lib/python3.11/site-packages/agate/type_tester.py:92: RuntimeWarning: "updated_at" does not match the name of any column in this table.
  warnings.warn('"%s" does not match the name of any column in this table.' % name, RuntimeWarning)


‚úÖ Successfully loaded seed config_promotion_hazard_tenure_multipliers

============================================================
RUNNING DBT MODEL: stg_config_job_levelsMarked step 'event_generation' for year 2025 as complete
‚úÖ Event generation pipeline completed (2.84s)
üìã Step 5: Workforce Snapshot Generation
üì∏ Generating workforce snapshot for year 2025
Marked step 'workforce_snapshot' for year 2025 as complete
‚úÖ Workforce snapshot generation completed (3.02s)
üìã Step 6: Validation & Metrics
   Snapshot: 5,255 total, 4,510 active employees
   Events: 5,628 total, 5,628 valid
üìä Validation results for year 2025:
   ‚Ä¢ Workforce continuity: ‚úÖ
   ‚Ä¢ Data quality: ‚úÖ
   ‚Ä¢ Growth metrics: ‚úÖ
Marked step 'validation_metrics' for year 2025 as complete
‚úÖ Validation & metrics completed (0.02s)
Marked step 'validation_metrics' for year 2025 as complete
‚úÖ Year 2025 completed in 5.9s

üóìÔ∏è  SIMULATING YEAR 2026
==================================================
Beginning simulation year 2026
üìã Step 1: Year Transition Validation (2025 ‚Üí 2026)
üîç Validating year transition: 2025 ‚Üí 2026
üìä Year 2025 snapshot: 5,255 total, 4,510 active employees
üìä Average age: 36.8, tenure: 3.8 years
üìä Found 5,628 events for year 2025
‚úÖ Year transition validation passed: 2025 ‚Üí 2026
Marked step 'year_transition' for year 2026 as complete
‚úÖ Year transition validation completed (0.02s)
üìã Step 2: Workforce Baseline Preparation
üìä Year 2026: Using previous year workforce
üìä Retrieving workforce count from year 2025
üìä Previous year (2025) workforce count: 4,510 employees
Starting workforce for 2026: 4,510 employees
Marked step 'workforce_baseline' for year 2026 as complete
‚úÖ Workforce baseline preparation completed (0.02s)
üìã Step 3: Workforce Requirements Calculation
üìà Growth calculation: +904 hires, -542 terminations
Marked step 'workforce_requirements' for year 2026 as complete
‚úÖ Workforce requirements calculation completed (0.00s)
üìã Step 4: Event Generation Pipeline
üé≤ Generating events for year 2026 with seed 43
Marked step 'event_generation' for year 2026 as complete
‚úÖ Event generation pipeline completed (2.99s)
üìã Step 5: Workforce Snapshot Generation
üì∏ Generating workforce snapshot for year 2026
Marked step 'workforce_snapshot' for year 2026 as complete
‚úÖ Workforce snapshot generation completed (5.77s)
üìã Step 6: Validation & Metrics
   Events: 5,685 total, 5,685 valid
üìä Validation results for year 2026:
   ‚Ä¢ Workforce continuity: ‚ùå
   ‚Ä¢ Data quality: ‚úÖ
   ‚Ä¢ Growth metrics: ‚ùå
Marked step 'validation_metrics' for year 2026 as complete
‚úÖ Validation & metrics completed (0.02s)
Marked step 'validation_metrics' for year 2026 as complete
‚úÖ Year 2026 completed in 8.8s

üóìÔ∏è  SIMULATING YEAR 2027
==================================================
Beginning simulation year 2027
üìã Step 1: Year Transition Validation (2026 ‚Üí 2027)
üîç Validating year transition: 2026 ‚Üí 2027
‚ùå No workforce snapshot found for year 2026
üìä Found 5,685 events for year 2026
‚ùå Year transition validation failed: 2026 ‚Üí 2027
‚ùå Year transition validation failed: Year transition validation failed for 2027
‚ùå Year 2027 simulation failed: Year transition validation failed for 2027
üí• Multi-year simulation failed: Year transition validation failed for 2027

============================================================

Executing command: dbt run --select stg_config_job_levels
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:11  Running with dbt=1.9.8
[0m14:52:12  Registered adapter: duckdb=1.8.1
[0m14:52:12  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:12
[0m14:52:12  Concurrency: 10 threads (target='dev_m4')
[0m14:52:12
[0m14:52:12  1 of 1 START sql table model main.stg_config_job_levels ........................ [RUN]
[0m14:52:12  1 of 1 OK created sql table model main.stg_config_job_levels ................... [[32mOK[0m in 0.07s]
[0m14:52:12
[0m14:52:12  Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:12
[0m14:52:12  [32mCompleted successfully[0m
[0m14:52:12
[0m14:52:12  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


‚úÖ Successfully ran stg_config_job_levels

============================================================
RUNNING DBT MODEL: int_baseline_workforce
============================================================

Executing command: dbt run --select int_baseline_workforce
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:13  Running with dbt=1.9.8
[0m14:52:13  Registered adapter: duckdb=1.8.1
[0m14:52:13  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:13
[0m14:52:13  Concurrency: 10 threads (target='dev_m4')
[0m14:52:13
[0m14:52:14  1 of 1 START sql table model main.int_baseline_workforce ....................... [RUN]
[0m14:52:14  1 of 1 OK created sql table model main.int_baseline_workforce .................. [[32mOK[0m in 0.09s]
[0m14:52:14
[0m14:52:14  Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:52:14
[0m14:52:14  [32mCompleted successfully[0m
[0m14:52:14
[0m14:52:14  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


‚úÖ Successfully ran int_baseline_workforce

============================================================
RUNNING DBT MODEL: int_workforce_previous_year
============================================================

Executing command: dbt run --select int_workforce_previous_year
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:15  Running with dbt=1.9.8
[0m14:52:15  Registered adapter: duckdb=1.8.1
[0m14:52:15  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:15
[0m14:52:15  Concurrency: 10 threads (target='dev_m4')
[0m14:52:15
[0m14:52:15  1 of 1 START sql table model main.int_workforce_previous_year .................. [RUN]
[0m14:52:15  1 of 1 OK created sql table model main.int_workforce_previous_year ............. [[32mOK[0m in 0.08s]
[0m14:52:15
[0m14:52:15  Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:52:15
[0m14:52:15  [32mCompleted successfully[0m
[0m14:52:15
[0m14:52:15  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


‚úÖ Successfully ran int_workforce_previous_year

============================================================
üìä WORKFORCE CALCULATION RESULTS
============================================================

‚úÖ Baseline workforce loaded: 4,378 active employees

üìã SIMULATION PARAMETERS:
   ‚Ä¢ Target growth rate: 3.0%
   ‚Ä¢ Total termination rate: 12.0%
   ‚Ä¢ New hire termination rate: 25.0%

üìä NEXT YEAR REQUIREMENTS:
   ‚Ä¢ Starting workforce: 4,378
   ‚Ä¢ Terminations needed: 526
   ‚Ä¢ Gross hires needed: 877
   ‚Ä¢ Expected new hire terminations: 219
   ‚Ä¢ Net workforce growth: +658

üßÆ CALCULATION FORMULAS:
   ‚Ä¢ experienced_formula: CEIL(4378 * 0.12) = 526
   ‚Ä¢ growth_formula: 4378 * 0.03 = 131.34
   ‚Ä¢ hiring_formula: CEIL((526 + 131.34) / (1 - 0.25)) = 877
   ‚Ä¢ new_hire_term_formula: ROUND(877 * 0.25) = 219

‚úÖ Workforce calculation completed successfully!

============================================================
üéØ SIMULATION EVENT GENERATION
============================================================

üìã EVENT GENERATION PARAMETERS:
   ‚Ä¢ Experienced terminations: 526
   ‚Ä¢ Total hires needed: 877
   ‚Ä¢ Expected new hire terminations: 219
   ‚Ä¢ Simulation year: 2025
   ‚Ä¢ Random seed: 42 (for reproducibility)

üéØ GENERATING ALL SIMULATION EVENTS for year 2025
   Using random seed: 42

üìã Generating 526 experienced termination events...
   ‚úÖ Generated 526 termination events

üìã Generating 877 hiring events...
   ‚úÖ Generated 877 hiring events

üìã Generating ~219 new hire termination events (rate: 25.0%)...
   ‚úÖ Generated 219 new hire termination events

üìã Generating merit raise events for eligible employees...
   ‚úÖ Generated 3569 merit raise events

üìã Generating promotion events for eligible employees...
‚úÖ Hazard configuration loaded in 0.001 seconds
üîç DEBUG: Found 3506 employees eligible for promotion
üîç DEBUG: Promotion decisions made for 3506 employees
   Total promoted: 437
üìä Promotion results by level:
   Level 1: 258/1922 promoted (13.4% actual vs 16.5% expected)
     Random values: min=0.000, max=0.999, mean=0.513
   Level 2: 154/1170 promoted (13.2% actual vs 14.0% expected)
     Random values: min=0.002, max=1.000, mean=0.496
   Level 3: 13/192 promoted (6.8% actual vs 3.9% expected)
     Random values: min=0.009, max=0.998, mean=0.515
   Level 4: 12/222 promoted (5.4% actual vs 6.9% expected)
     Random values: min=0.006, max=0.999, mean=0.525

‚è±Ô∏è  Promotion event generation completed in 0.078 seconds
   Performance: 5608.1 events/second
   ‚úÖ Generated 437 promotion events

üíæ Storing all 5628 events in database...
‚úÖ Stored 5628 events in fct_yearly_events

‚úÖ EVENT GENERATION SUMMARY:
   ‚Ä¢ Experienced terminations: 526
   ‚Ä¢ New hires: 877
   ‚Ä¢ New hire terminations: 219
   ‚Ä¢ Merit raises: 3569
   ‚Ä¢ Promotions: 437
   ‚Ä¢ Total events: 5628
   ‚Ä¢ Net workforce change: 132
   ‚Ä¢ Expected net change: 132

üîç Validating all generated events...

üìä EVENT VALIDATION RESULTS for fct_yearly_events
   Total events: 5628
   Events by type:
     ‚Ä¢ raise: 3569
     ‚Ä¢ hire: 877
     ‚Ä¢ termination: 745
     ‚Ä¢ promotion: 437
   Data quality:
     ‚Ä¢ VALID: 5628

‚úÖ Event generation completed successfully!

üìã Initial Progress Status:
Simulation Progress Summary:
========================================
‚óã Pre-simulation setup
‚óã Year 2025
  ‚óã Year Transition
  ‚óã Workforce Baseline
  ‚óã Workforce Requirements
  ‚óã Event Generation
  ‚óã Workforce Snapshot
  ‚óã Validation Metrics
‚óã Year 2026
  ‚óã Year Transition
  ‚óã Workforce Baseline
  ‚óã Workforce Requirements
  ‚óã Event Generation
  ‚óã Workforce Snapshot
  ‚óã Validation Metrics
‚óã Year 2027
  ‚óã Year Transition
  ‚óã Workforce Baseline
  ‚óã Workforce Requirements
  ‚óã Event Generation
  ‚óã Workforce Snapshot
  ‚óã Validation Metrics
‚óã Year 2028
  ‚óã Year Transition
  ‚óã Workforce Baseline
  ‚óã Workforce Requirements
  ‚óã Event Generation
  ‚óã Workforce Snapshot
  ‚óã Validation Metrics
‚óã Year 2029
  ‚óã Year Transition
  ‚óã Workforce Baseline
  ‚óã Workforce Requirements
  ‚óã Event Generation
  ‚óã Workforce Snapshot
  ‚óã Validation Metrics

üéØ GENERATING ALL SIMULATION EVENTS for year 2025
   Using random seed: 42

üìã Generating 526 experienced termination events...
   ‚úÖ Generated 526 termination events

üìã Generating 877 hiring events...
   ‚úÖ Generated 877 hiring events

üìã Generating ~219 new hire termination events (rate: 25.0%)...
   ‚úÖ Generated 219 new hire termination events

üìã Generating merit raise events for eligible employees...
   ‚úÖ Generated 3569 merit raise events

üìã Generating promotion events for eligible employees...
‚úÖ Hazard configuration loaded in 0.001 seconds
üîç DEBUG: Found 3506 employees eligible for promotion
üîç DEBUG: Promotion decisions made for 3506 employees
   Total promoted: 437
üìä Promotion results by level:
   Level 1: 258/1922 promoted (13.4% actual vs 16.5% expected)
     Random values: min=0.000, max=0.999, mean=0.513
   Level 2: 154/1170 promoted (13.2% actual vs 14.0% expected)
     Random values: min=0.002, max=1.000, mean=0.496
   Level 3: 13/192 promoted (6.8% actual vs 3.9% expected)
     Random values: min=0.009, max=0.998, mean=0.515
   Level 4: 12/222 promoted (5.4% actual vs 6.9% expected)
     Random values: min=0.006, max=0.999, mean=0.525

‚è±Ô∏è  Promotion event generation completed in 0.073 seconds
   Performance: 6007.9 events/second
   ‚úÖ Generated 437 promotion events

üíæ Storing all 5628 events in database...
‚úÖ Stored 5628 events in fct_yearly_events

‚úÖ EVENT GENERATION SUMMARY:
   ‚Ä¢ Experienced terminations: 526
   ‚Ä¢ New hires: 877
   ‚Ä¢ New hire terminations: 219
   ‚Ä¢ Merit raises: 3569
   ‚Ä¢ Promotions: 437
   ‚Ä¢ Total events: 5628
   ‚Ä¢ Net workforce change: 132
   ‚Ä¢ Expected net change: 132

üîÑ Generating workforce snapshot for year 2025...
   Starting workforce: 4,378 employees

   Running fct_workforce_snapshot model...

============================================================
RUNNING DBT MODEL WITH VARS: fct_workforce_snapshot
Variables: {'simulation_year': 2025}
============================================================

Executing command: dbt run --select fct_workforce_snapshot --vars {simulation_year=2025}
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:22  Running with dbt=1.9.8
[0m14:52:22  Registered adapter: duckdb=1.8.1
[0m14:52:22  Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:52:23  The configured adapter does not support metadata-based freshness. A loaded_at_field must be specified for source 'snapshots.scd_workforce_state'.
[0m14:52:24  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:24
[0m14:52:24  Concurrency: 10 threads (target='dev_m4')
[0m14:52:24
[0m14:52:24  1 of 1 START sql table model main.fct_workforce_snapshot ....................... [RUN]
[0m14:52:24  1 of 1 OK created sql table model main.fct_workforce_snapshot .................. [[32mOK[0m in 0.16s]
[0m14:52:24
[0m14:52:24  Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:52:24
[0m14:52:24  [32mCompleted successfully[0m
[0m14:52:24
[0m14:52:24  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
2025-07-22 10:52:24.201 Python[5211:1515600] CFPropertyListCreateFromXMLData(): Old-style plist parser: missing semicolon in dictionary on line 1. Parsing will be abandoned. Break on _CFPropertyListMissingSemicolon to debug.
2025-07-22 10:52:24.201 Python[5211:1515600] CFPropertyListCreateFromXMLData(): Old-style plist parser: missing semicolon in dictionary on line 1. Parsing will be abandoned. Break on _CFPropertyListMissingSemicolon to debug.


‚úÖ Successfully ran fct_workforce_snapshot with variables

üéØ GENERATING ALL SIMULATION EVENTS for year 2026
   Using random seed: 43

üìã Generating 542 experienced termination events...
   ‚úÖ Generated 542 termination events

üìã Generating 904 hiring events...
   ‚úÖ Generated 904 hiring events

üìã Generating ~226 new hire termination events (rate: 25.0%)...
   ‚úÖ Generated 226 new hire termination events

üìã Generating merit raise events for eligible employees...
   ‚úÖ Generated 3569 merit raise events

üìã Generating promotion events for eligible employees...
‚úÖ Hazard configuration loaded in 0.000 seconds
üîç DEBUG: Found 3506 employees eligible for promotion
üîç DEBUG: Promotion decisions made for 3506 employees
   Total promoted: 444
üìä Promotion results by level:
   Level 1: 279/1922 promoted (14.5% actual vs 16.5% expected)
     Random values: min=0.000, max=1.000, mean=0.500
   Level 2: 135/1170 promoted (11.5% actual vs 14.0% expected)
     Random values: min=0.002, max=0.999, mean=0.498
   Level 3: 18/192 promoted (9.4% actual vs 3.9% expected)
     Random values: min=0.004, max=0.992, mean=0.488
   Level 4: 12/222 promoted (5.4% actual vs 6.9% expected)
     Random values: min=0.002, max=1.000, mean=0.512

‚è±Ô∏è  Promotion event generation completed in 0.081 seconds
   Performance: 5458.6 events/second
   ‚úÖ Generated 444 promotion events

üíæ Storing all 5685 events in database...
‚úÖ Stored 5685 events in fct_yearly_events

‚úÖ EVENT GENERATION SUMMARY:
   ‚Ä¢ Experienced terminations: 542
   ‚Ä¢ New hires: 904
   ‚Ä¢ New hire terminations: 226
   ‚Ä¢ Merit raises: 3569
   ‚Ä¢ Promotions: 444
   ‚Ä¢ Total events: 5685
   ‚Ä¢ Net workforce change: 136
   ‚Ä¢ Expected net change: 136

üîÑ Generating workforce snapshot for year 2026...
   Starting workforce: 4,510 employees

   Running fct_workforce_snapshot model...
   Preparing previous year workforce data for year 2026...
   ‚úÖ Successfully prepared previous year workforce data

============================================================
RUNNING DBT MODEL WITH VARS: fct_workforce_snapshot
Variables: {'simulation_year': 2026}
============================================================

Executing command: dbt run --select fct_workforce_snapshot --vars {simulation_year=2026}
Working directory: /Users/nicholasamaral/planwise_navigator/dbt
----------------------------------------
[0m14:52:31  Running with dbt=1.9.8
[0m14:52:31  Registered adapter: duckdb=1.8.1
[0m14:52:31  Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:52:32  The configured adapter does not support metadata-based freshness. A loaded_at_field must be specified for source 'snapshots.scd_workforce_state'.
[0m14:52:32  Found 43 models, 2 snapshots, 14 seeds, 311 data tests, 1 source, 900 macros
[0m14:52:32
[0m14:52:32  Concurrency: 10 threads (target='dev_m4')
[0m14:52:32
[0m14:52:33  1 of 1 START sql table model main.fct_workforce_snapshot ....................... [RUN]
[0m14:52:33  1 of 1 OK created sql table model main.fct_workforce_snapshot .................. [[32mOK[0m in 0.17s]
[0m14:52:33
[0m14:52:33  Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m14:52:33
[0m14:52:33  [32mCompleted successfully[0m
[0m14:52:33
[0m14:52:33  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


STDERR:
2025-07-22 10:52:33.023 Python[5275:1516420] CFPropertyListCreateFromXMLData(): Old-style plist parser: missing semicolon in dictionary on line 1. Parsing will be abandoned. Break on _CFPropertyListMissingSemicolon to debug.
2025-07-22 10:52:33.023 Python[5275:1516420] CFPropertyListCreateFromXMLData(): Old-style plist parser: missing semicolon in dictionary on line 1. Parsing will be abandoned. Break on _CFPropertyListMissingSemicolon to debug.


‚úÖ Successfully ran fct_workforce_snapshot with variables

‚ùå Multi-year simulation failed: Year transition validation failed for 2027


‚ùå FATAL ERROR: Year transition validation failed for 2027
